sequenceDiagram
    participant User as User / Agent
    participant CLI as manifest_manager.py
    participant Templates as resources/base-manifests/
    participant Manifest as file-manifest.json
    participant Bundler as bundle.py
    participant Output as bundle.md

    Note over User, Output: Phase 1: Initialize

    User->>CLI: init --target MyTool --type generic
    CLI->>Templates: Load base-{type}-file-manifest.json
    Templates-->>CLI: Template with default entries
    CLI->>CLI: Substitute [TARGET] placeholders
    CLI->>Manifest: Write new manifest JSON
    CLI-->>User: âœ… Manifest initialized

    Note over User, Output: Phase 2: Curate

    loop Add files to manifest
        User->>CLI: add --path "src/main.py" --note "Entry point"
        CLI->>Manifest: Load â†’ deduplicate â†’ append â†’ save
        CLI-->>User: âœ… Added to manifest
    end

    opt Remove unwanted files
        User->>CLI: remove --path "old_file.py"
        CLI->>Manifest: Load â†’ filter â†’ save
        CLI-->>User: âœ… Removed
    end

    opt Search / List
        User->>CLI: list (or search "pattern")
        CLI->>Manifest: Load â†’ display
        CLI-->>User: ğŸ“‹ Manifest contents
    end

    Note over User, Output: Phase 3: Bundle

    User->>CLI: bundle --output my-bundle.md
    CLI->>Manifest: Load manifest JSON
    CLI->>Bundler: bundle_files(manifest, output)
    loop For each file entry
        Bundler->>Bundler: resolve_path(file.path)
        alt File exists
            Bundler->>Bundler: Read content, detect language
            Bundler->>Output: Write header + fenced code block
        else File missing
            Bundler->>Output: Write âŒ MISSING warning
        end
        alt Path is directory
            Bundler->>Bundler: os.walk() recursive expansion
            Bundler->>Output: Write all child files
        end
    end
    Bundler->>Output: Write TOC + all content
    Bundler-->>User: âœ… Bundle created at my-bundle.md
