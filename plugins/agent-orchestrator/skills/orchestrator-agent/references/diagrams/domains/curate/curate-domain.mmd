flowchart TD
    User([User / Agent])

    subgraph CommandInterface [Curate Domain Interface]
        CmdIngest["/curate-ingest-vector"]
        CmdDistill["/curate-distill-rlm"]
        CmdInv["/curate-update-inventory"]
        CmdLinks["/curate-enrich-links"]
        CmdAudit["/curate-audit-log"]
        CmdManInit["/curate-manifest"]
        CmdManAdd["/curate-manifest-add"]
        CmdManList["/curate-manifest-list"]
        CmdManBundle["/curate-bundle"]
    end

    subgraph LogicLayer [curation Scripts]
        IngestScript["ingest.py"]
        DistillScript["distiller.py"]
        InvScript["build_master_collection.py"]
        LinkScript["enrich_links_v2.py"]
        AuditScript["update_analysis_tracking.py"]
        ManScript["manifest_manager.py"]
    end

    subgraph DataStore [Project Memory]
        VecDB[("Vector Database")]
        RLM[("RLM Cache
        (Summaries)")]
        MasterInv[("inventory.json")]
        Tracking[("ai_analysis_tracking.json")]
        Docs[("Markdown Documentation")]
        Manifest[("file-manifest.json")]
    end

    %% Wiring
    User --> CmdIngest
    User --> CmdDistill
    User --> CmdInv
    User --> CmdLinks
    User --> CmdAudit
    User --> CmdManInit
    User --> CmdManAdd
    User --> CmdManList
    User --> CmdManBundle

    CmdIngest --> IngestScript
    CmdDistill --> DistillScript
    CmdInv --> InvScript
    CmdLinks --> LinkScript
    CmdAudit --> AuditScript
    CmdManInit --> ManScript
    CmdManAdd --> ManScript
    CmdManList --> ManScript
    CmdManBundle --> ManScript

    %% Actions
    IngestScript -->|"Writes"| VecDB
    DistillScript -->|"Refreshes"| RLM
    InvScript -->|"Rebuilds"| MasterInv
    LinkScript -->|"Modifies"| Docs
    AuditScript -->|"Updates"| Tracking
    ManScript -->|"Manages"| Manifest

    classDef command fill:#f9c,stroke:#333,stroke-width:2px;
    classDef script fill:#bbf,stroke:#333,stroke-width:2px;
    classDef data fill:#ff9,stroke:#333,stroke-width:2px;

    class CmdIngest,CmdDistill,CmdInv,CmdLinks,CmdAudit,CmdManInit,CmdManAdd,CmdManList,CmdManBundle command;
    class IngestScript,DistillScript,InvScript,LinkScript,AuditScript,ManScript script;
    class VecDB,RLM,MasterInv,Tracking,Docs,Manifest data;
