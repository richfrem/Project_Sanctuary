%% MCP Domain Architecture v2.0 - 8 Domain Servers
%% Project Sanctuary - Domain-Driven MCP Ecosystem
%% Created: 2025-11-25
%% Status: Refined with Config and Code domains

graph TB
    subgraph "LLM Assistant Layer"
        LLM[AI Assistant<br/>Gemini/Claude/GPT]
    end
    
    subgraph "MCP Domain Servers (8 Total)"
        direction TB
        
        subgraph "Document Domains (Content Management)"
            Chronicle[ğŸ“– Chronicle MCP<br/>Historical Truth]
            Protocol[âš–ï¸ Protocol MCP<br/>Governing Rules]
            ADR[ğŸ“‹ ADR MCP<br/>Decision History]
            Task[âœ… Task MCP<br/>Execution Planning]
        end
        
        subgraph "Cognitive Domains (Non-Mechanical)"
            Cortex[ğŸ§  Cortex MCP<br/>Knowledge Retrieval]
            Council[ğŸ‘¥ Council MCP<br/>AI Deliberation]
        end
        
        subgraph "System Domains (High-Safety Critical)"
            Config[âš™ï¸ Config MCP<br/>System Configuration]
            Code[ğŸ’» Code MCP<br/>Source Code & Scripts]
        end
    end
    
    subgraph "Shared Infrastructure"
        direction LR
        Git[ğŸ” Git Operations<br/>P101 Compliance]
        Safety[ğŸ›¡ï¸ Safety Validator<br/>Protection Levels]
        Schema[ğŸ“ Schema Validator<br/>Type Checking]
        Vault[ğŸ”’ Secret Vault<br/>Sensitive Data]
    end
    
    subgraph "Project Sanctuary Storage"
        direction TB
        ChronicleDir[(00_CHRONICLE/)]
        ProtocolDir[(01_PROTOCOLS/)]
        ADRDir[(ADRs/)]
        TaskDir[(TASKS/)]
        CortexDir[(mnemonic_cortex/)]
        CouncilDir[(council_orchestrator/)]
        ConfigDir[(.agent/config/)]
        CodeDir[(src/, scripts/, tools/)]
    end
    
    %% LLM to MCP connections
    LLM -->|MCP Protocol| Chronicle
    LLM -->|MCP Protocol| Protocol
    LLM -->|MCP Protocol| ADR
    LLM -->|MCP Protocol| Task
    LLM -->|MCP Protocol| Cortex
    LLM -->|MCP Protocol| Council
    LLM -->|MCP Protocol| Config
    LLM -->|MCP Protocol| Code
    
    %% Document domains use standard infrastructure
    Chronicle --> Git
    Chronicle --> Safety
    Chronicle --> Schema
    
    Protocol --> Git
    Protocol --> Safety
    Protocol --> Schema
    
    ADR --> Git
    ADR --> Safety
    ADR --> Schema
    
    Task --> Git
    Task --> Safety
    Task --> Schema
    
    %% Cognitive domains use safety/schema only
    Cortex --> Safety
    Cortex --> Schema
    
    Council --> Safety
    Council --> Schema
    
    %% System domains use ALL infrastructure + Vault
    Config --> Git
    Config --> Safety
    Config --> Schema
    Config --> Vault
    
    Code --> Git
    Code --> Safety
    Code --> Schema
    
    %% Storage connections
    Chronicle --> ChronicleDir
    Protocol --> ProtocolDir
    ADR --> ADRDir
    Task --> TaskDir
    Cortex --> CortexDir
    Council --> CouncilDir
    Config --> ConfigDir
    Code --> CodeDir
    
    %% Styling
    classDef documentDomain fill:#e8f5e8,stroke:#2d5016,stroke-width:2px
    classDef cognitiveDomain fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef systemDomain fill:#ffcccc,stroke:#c62828,stroke-width:3px
    classDef infrastructure fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef storage fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    
    class Chronicle,Protocol,ADR,Task documentDomain
    class Cortex,Council cognitiveDomain
    class Config,Code systemDomain
    class Git,Safety,Schema,Vault infrastructure
    class ChronicleDir,ProtocolDir,ADRDir,TaskDir,CortexDir,CouncilDir,ConfigDir,CodeDir storage
