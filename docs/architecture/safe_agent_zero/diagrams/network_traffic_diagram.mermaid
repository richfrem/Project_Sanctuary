flowchart TB
    internet((User / Internet / API))

    subgraph "Docker Host (MacMini M4)"
        subgraph "Frontend Network (Public)"
            guard[fa:fa-shield Nginx Guard]
        end

        subgraph "Control Network (Internal)"
            agent["fa:fa-brain Agent Zero<br/>(OpenClaw)"]
            dns["fa:fa-compass CoreDNS<br/>(DNS Filter)"]
        end

        subgraph "Execution Network (Air-Gapped / Egress Controlled)"
            scout["fa:fa-eye Scout<br/>(Browser Sub-Agent)"]
            squid["fa:fa-filter Squid Proxy<br/>(Egress Control)"]
        end
    end

    %% Ingress Flow
    internet -- "HTTPS:443 (MFA)" --> guard
    guard -- "ACP Command" --> agent

    %% Internal Services
    agent -- "DNS Query (Whitelist)" --> dns
    dns -. "Block" .-> internet

    %% Egress Flow (Filtered)
    agent -- "HTTP CONNECT (Explicit Proxy)" --> squid
    squid -- "Whitelisted APIs Only" --> internet
    
    %% Execution Flow (Isolated)
    agent -- "CDP Control (Unidirectional)" --> scout
    scout -- "Open Internet (Any Site)" --> internet
    
    %% Lateral Movement Block
    scout -. "FIREWALL DENY" .-> agent

    %% Styling
    style guard fill:#f9f,stroke:#333,stroke-width:2px
    style agent fill:#bbf,stroke:#333,stroke-width:2px
    style scout fill:#bfb,stroke:#333,stroke-width:2px
    style squid fill:#f96,stroke:#333,stroke-width:2px
    style dns fill:#9f9,stroke:#333,stroke-width:2px

    linkStyle 7 stroke:red,stroke-width:4px,stroke-dasharray: 5 5;
