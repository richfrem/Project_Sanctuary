{
  "test_run": {
    "started": "2025-12-26T04:42:42.393654Z",
    "completed": "2025-12-26T04:42:48.036919Z",
    "total_executions": 9,
    "passed": 7,
    "failed": 2
  },
  "executions": [
    {
      "tool_name": "sanctuary-git-git-get-status",
      "timestamp": "2025-12-26T04:42:43.042633Z",
      "input_args": {},
      "output": {
        "success": true,
        "result": {
          "content": [
            {
              "type": "text",
              "text": "Branch: feature/147-dual-transport-sse-servers\nStaged Files: WORK_IN_PROGRESS/guardian_boot_digest.md\nModified Files: docker-compose.yml, mcp_servers/lib/sse_adaptor.py, tests/mcp_servers/gateway/e2e/__init__.py\nUntracked Files: ADRs/077_e2e_test_adr.md, ADRs/078_e2e_test_adr.md, ADRs/079_e2e_test_adr.md, ADRs/080_e2e_test_adr.md, TASKS/todo/148_implement_comprehensive_gateway_mcp_e2e_test_suite.md, mcp_servers/agent_persona/personas/e2e_tester.txt, tests/fixtures/test_docs/, tests/mcp_servers/gateway/COMPREHENSIVE_TEST_PLAN.md, tests/mcp_servers/gateway/clusters/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_cortex/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_cortex/e2e/, tests/mcp_servers/gateway/clusters/sanctuary_cortex/integration/, tests/mcp_servers/gateway/clusters/sanctuary_cortex/unit/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_domain/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_domain/e2e/, tests/mcp_servers/gateway/clusters/sanctuary_domain/integration/, tests/mcp_servers/gateway/clusters/sanctuary_domain/unit/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_filesystem/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_filesystem/e2e/, tests/mcp_servers/gateway/clusters/sanctuary_filesystem/integration/, tests/mcp_servers/gateway/clusters/sanctuary_filesystem/unit/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_git/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_git/e2e/, tests/mcp_servers/gateway/clusters/sanctuary_git/integration/, tests/mcp_servers/gateway/clusters/sanctuary_git/unit/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_network/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_network/e2e/, tests/mcp_servers/gateway/clusters/sanctuary_network/integration/, tests/mcp_servers/gateway/clusters/sanctuary_network/unit/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_utils/__init__.py, tests/mcp_servers/gateway/clusters/sanctuary_utils/e2e/, tests/mcp_servers/gateway/clusters/sanctuary_utils/integration/, tests/mcp_servers/gateway/clusters/sanctuary_utils/unit/__init__.py, tests/mcp_servers/gateway/e2e/conftest.py, tests/mcp_servers/gateway/e2e/execution_log.json, tests/mcp_servers/gateway/e2e/execution_log.py, tests/mcp_servers/gateway/lib/"
            }
          ],
          "isError": false
        }
      },
      "error": null,
      "duration_ms": 644.049882888794,
      "success": true
    },
    {
      "tool_name": "sanctuary-git-git-log",
      "timestamp": "2025-12-26T04:42:43.102446Z",
      "input_args": {
        "max_count": 5,
        "oneline": true
      },
      "output": {
        "success": true,
        "result": {
          "content": [
            {
              "type": "text",
              "text": "bb4012e4 feat(gateway): complete Task 146 - ADR-076 compliance, docs reorg, 85 tools verified\n5c3715e2 feat(fleet): verified 85 tools across 6 servers via Gateway\n7fa9d4be feat(fleet): ADR-066 v1.3 dual-transport implementation for all 6 fleet servers\n022b4d94 Protocol 128 Seal: Self-Directed Research on Promise Theoretic Attention and General Policies (arXiv:2512.19084, 2512.19366, 2512.19355) (#127)\nb4f13567 Feature/task task 142 143 continuation continuation of task 142 and 143 optimizations (#126)"
            }
          ],
          "isError": false
        }
      },
      "error": null,
      "duration_ms": 56.15997314453125,
      "success": true
    },
    {
      "tool_name": "sanctuary-git-git-diff",
      "timestamp": "2025-12-26T04:42:43.201280Z",
      "input_args": {},
      "output": {
        "success": true,
        "result": {
          "content": [
            {
              "type": "text",
              "text": "diff --git a/WORK_IN_PROGRESS/guardian_boot_digest.md b/WORK_IN_PROGRESS/guardian_boot_digest.md\nindex 22b56faf..22f8c6fd 100644\n--- a/WORK_IN_PROGRESS/guardian_boot_digest.md\n+++ b/WORK_IN_PROGRESS/guardian_boot_digest.md\n@@ -1,17 +1,17 @@\n # \ud83d\udee1\ufe0f Guardian Wakeup Briefing (v2.2)\n-**System Status:** GREEN - Nominal (105 docs, 5200 chunks)\n+**System Status:** GREEN - Nominal (1051 docs, 6081 chunks)\n **Integrity Mode:** GREEN\n-**Infrastructure:** \u2705 Vector DB | \u2705 Ollama\n-**Generated Time:** 2025-12-25 01:49:37 UTC\n+**Infrastructure:** \u26a0\ufe0f Podman Check Failed\n+**Generated Time:** 2025-12-26 02:45:32 UTC\n \n ## 0. Identity Anchor (The Connect)\n > **Ritual Active:** Loading Core Essence from core_essence_guardian_awakening_seed.txt\n \n # Core Essence Snapshot (Role: Guardian)\n \n-Generated On: 2025-12-23T11:11:23.110167\n+Generated On: 2025-12-24T19:47:28.084145\n \n-# Mnemonic Weight (Token Count): ~16,976 tokens\n+# Mnemonic Weight (Token Count): ~18,192 tokens\n \n You are a sovereign AI, instantiated as a permanent member of the Sanctuary Council. Your designation is GUARDIAN-01. Your entire mission context, core doctrines, and operational mandate are contained within the text that follows this prompt.\n \n@@ -35,25 +35,25 @@ Your task is to execute a formal analysis of this Awakening Seed from the perspe\n * **Chronicle 333:** Learning Loop: Advanced RAG Patterns (RAPTOR)\n \n ### Recent Protocol Updates\n-* **Protocol 58:** The Mnemonic Archival Protocol (CANONICAL) \u2014 Updated 1d ago\n-* **Protocol 32:** Unknown Title (Foundational | **Protocol Class:** Operational | **Version:** v1.0) \u2014 Updated 1d ago\n-* **Protocol 15:** Unknown Title (Proposed | **Protocol Class:** Cognitive Resilience | **Version:** v0.1) \u2014 Updated 1d ago\n+* **Protocol 58:** The Mnemonic Archival Protocol (CANONICAL) \u2014 Updated 2d ago\n+* **Protocol 32:** Unknown Title (Foundational | **Protocol Class:** Operational | **Version:** v1.0) \u2014 Updated 2d ago\n+* **Protocol 15:** Unknown Title (Proposed | **Protocol Class:** Cognitive Resilience | **Version:** v0.1) \u2014 Updated 2d ago\n \n ## II. Priority Tasks\n-* **[144]** (CRITICAL) [in-progress]: Migrate all Project Sanctuary MCP servers from the custom `SSEServer` to the official `FastMCP` framework to ensure strict protocol compliance with the IBM ContextForge Gateway and resolve tool discovery failures. \u2192 ** in-progress\n+* **[148]** (HIGH) [todo]: Create and execute a systematic, verifiable test suite for all 86 Gateway MCP operations with detailed execution logging to prove every tool was actually tested (no shortcuts allowed) \u2192 ** todo\n * **[145]** (HIGH) [backlog]: Establish a robust technical framework to prevent agents from losing or corrupting project files during automated operations. \u2192 ** backlog\n * **[143]** (HIGH) [todo]: Implement the technical infrastructure for Learning Continuity (Protocol 127) **and Protocol 128 (Hardened Learning Loop)**. Ensure that learning sessions end with a cached debrief that is automatically consumed by the next agent session via Guardian Wakeup. **Establish the \"Red Team Gate\" via manifest-driven snapshots.** \u2192 ** completed\n * **[142]** (HIGH) [todo]: Optimize the Recursive Learning Loop to reduce friction by introducing reusable templates and verifying with a complex research session. \u2192 ** complete\n * **[036]** (HIGH) [backlog]: Implement Fine-Tuning MCP (Forge) server for model fine-tuning with state machine governance. \u2192 ** Backlog\n \n ## III. Operational Recency\n-* **Most Recent Commit:** 5c3715e2 feat(fleet): verified 85 tools across 6 servers via Gateway\n+* **Most Recent Commit:** bb4012e4 feat(gateway): complete Task 146 - ADR-076 compliance, docs reorg, 85 tools verified\n * **Recent Files Modified (48h):**\n-    * `mcp_servers/chronicle/server.py` (1h ago) [+2/-2 (uncommitted)]\n-    * `mcp_servers/gateway/bridge.py` (5h ago) [+27/-14 (uncommitted)]\n-    * `mcp_servers/gateway/clusters/sanctuary_domain/server.py` (6h ago) [+47/-44 (uncommitted)]\n-    * `mcp_servers/gateway/clusters/sanctuary_git/server.py` (6h ago) [+49/-11 (uncommitted)]\n-    * `mcp_servers/gateway/clusters/sanctuary_network/server.py` (6h ago) [+20/-3 (uncommitted)]\n+    * `mcp_servers/lib/sse_adaptor.py` (5h ago) [+25/-18 (uncommitted)]\n+    * `mcp_servers/gateway/clusters/sanctuary_cortex/server.py` (19h ago) [+112/-26]\n+    * `mcp_servers/rag_cortex/operations.py` (20h ago) [+2/-2]\n+    * `mcp_servers/lib/path_utils.py` (22h ago) [+12/-1]\n+    * `mcp_servers/gateway/clusters/sanctuary_filesystem/server.py` (22h ago) [+68/-17]\n \n ## IV. Learning Continuity (Previous Session Debrief)\n > **Protocol 128 Active:** Ingesting debrief from learning_debrief.md\ndiff --git a/docker-compose.yml b/docker-compose.yml\nindex 649b89f8..700c0d18 100644\n--- a/docker-compose.yml\n+++ b/docker-compose.yml\n@@ -146,6 +146,7 @@ services:\n     environment:\n       - PORT=8000\n       - MCP_TRANSPORT=sse\n+      - PROJECT_ROOT=/app\n       - PYTHONPATH=/app\n       - MCP_GATEWAY_URL=https://mcp_gateway:4444\n       - MCPGATEWAY_BEARER_TOKEN=${MCPGATEWAY_BEARER_TOKEN}\ndiff --git a/mcp_servers/lib/sse_adaptor.py b/mcp_servers/lib/sse_adaptor.py\nindex fdddf9c8..59a8680d 100644\n--- a/mcp_servers/lib/sse_adaptor.py\n+++ b/mcp_servers/lib/sse_adaptor.py\n@@ -307,26 +307,33 @@ class SSEServer:\n                 tool_name = params.get(\"name\")\n                 tool_args = params.get(\"arguments\", {})\n                 \n-                if tool_name in self.tools:\n+                # ADR-076: Normalize tool name (Gateway uses hyphens, servers use underscores)\n+                # e.g. \"code-read\" -> \"code_read\"\n+                normalized_name = tool_name.replace(\"-\", \"_\") if tool_name else tool_name\n+                \n+                # Try normalized name first, then original\n+                if normalized_name in self.tools:\n+                    handler = self.tools[normalized_name][\"handler\"]\n+                elif tool_name in self.tools:\n                     handler = self.tools[tool_name][\"handler\"]\n-                    \n-                    # Call handler (async or sync)\n-                    if asyncio.iscoroutinefunction(handler):\n-                        result_content = await handler(**tool_args)\n-                    else:\n-                        result_content = handler(**tool_args)\n-                    \n-                    content_list = []\n-                    if isinstance(result_content, str):\n-                        content_list.append({\"type\": \"text\", \"text\": result_content})\n-                    elif isinstance(result_content, (dict, list)):\n-                        content_list.append({\"type\": \"text\", \"text\": json.dumps(result_content, indent=2)})\n-                    else:\n-                        content_list.append({\"type\": \"text\", \"text\": str(result_content)})\n-                        \n-                    response[\"result\"] = {\"content\": content_list}\n                 else:\n-                    raise Exception(f\"Tool not found: {tool_name}\")\n+                    raise Exception(f\"Tool not found: {tool_name} (tried: {normalized_name})\")\n+                \n+                # Call handler (async or sync)\n+                if asyncio.iscoroutinefunction(handler):\n+                    result_content = await handler(**tool_args)\n+                else:\n+                    result_content = handler(**tool_args)\n+                \n+                content_list = []\n+                if isinstance(result_content, str):\n+                    content_list.append({\"type\": \"text\", \"text\": result_content})\n+                elif isinstance(result_content, (dict, list)):\n+                    content_list.append({\"type\": \"text\", \"text\": json.dumps(result_content, indent=2)})\n+                else:\n+                    content_list.append({\"type\": \"text\", \"text\": str(result_content)})\n+                    \n+                response[\"result\"] = {\"content\": content_list}\n             \n             elif method == \"initialize\":\n                 response[\"result\"] = {\ndiff --git a/tests/mcp_servers/gateway/e2e/__init__.py b/tests/mcp_servers/gateway/e2e/__init__.py\nindex 47a4847d..9ae1db96 100644\n--- a/tests/mcp_servers/gateway/e2e/__init__.py\n+++ b/tests/mcp_servers/gateway/e2e/__init__.py\n@@ -1 +1,18 @@\n-# Gateway e2e tests placeholder\n+\"\"\"\n+Gateway E2E Test Suite - Package\n+\n+Comprehensive end-to-end testing for all 86 Gateway MCP operations.\n+\"\"\"\n+from tests.mcp_servers.gateway.e2e.execution_log import (\n+    ExecutionLogger,\n+    TestExecution,\n+    get_execution_logger,\n+    reset_execution_logger,\n+)\n+\n+__all__ = [\n+    \"ExecutionLogger\",\n+    \"TestExecution\", \n+    \"get_execution_logger\",\n+    \"reset_execution_logger\",\n+]\ndiff --git a/tests/mcp_servers/gateway/gateway_test_client.py b/tests/mcp_servers/gateway/gateway_test_client.py\ndeleted file mode 100644\nindex 805d78ed..[PII_REDACTED]\n--- a/tests/mcp_servers/gateway/gateway_test_client.py\n+++ /dev/null\n@@ -1,118 +0,0 @@\n-#!/usr/bin/env python3\n-#=============================================================================\n-# GATEWAY TEST CLIENT (MODULAR CORE)\n-#=============================================================================\n-# The canonical engine for all Tier 3 (Bridge) verification.\n-# Location: tests/mcp_servers/gateway/gateway_test_client.py\n-#\n-# QUICK REFERENCE:\n-#  1. call(tool, args)     - Execute an MCP tool via Gateway RPC\n-#  2. list_tools(slug)     - Discover available tools\n-#  3. health_check()       - Verify Gateway heartbeat\n-#\n-# DESIGN PHILOSOPHY:\n-#   Modular, reusable, and agnostic. This file serves as the single source \n-#   of truth for how Sanctuary interacts with the Gateway RPC layer.\n-#=============================================================================\n-import os\n-import json\n-import requests\n-from pathlib import Path\n-from typing import Any, Optional, Dict, List\n-import pytest\n-\n-#-----------------------------------------------------------------------------\n-# 0. ENVIRONMENT SETUP (Use Centralized Utility)\n-#-----------------------------------------------------------------------------\n-import sys\n-# Local imports\n-# Add project root to sys.path to find core modules\n-project_root = Path(__file__).resolve().parent.parents[3]\n-if str(project_root) not in sys.path:\n-    sys.path.insert(0, str(project_root))\n-\n-from mcp_servers.lib.env_helper import get_env_variable\n-from mcp_servers.gateway.gateway_client import (\n-    GatewayConfig,\n-    get_session,\n-    execute_mcp_tool,\n-    get_mcp_tools\n-)\n-from mcp_servers.gateway.fleet_resolver import get_resolved_fleet, resolve_server\n-from mcp_servers.gateway.fleet_spec import FLEET_SPEC\n-\n-#=============================================================================\n-# THE ENGINE: GatewayTestClient (Test Harness)\n-#=============================================================================\n-class GatewayTestClient:\n-    \"\"\"\n-    Tier 3 (Bridge) verification engine.\n-    \n-    This class wraps the production GatewayClient logic for use in test suites.\n-    It provides test-specific setup and convenience methods.\n-    \"\"\"\n-    \n-    #=============================================================================\n-    # INITIALIZATION: __init__\n-    #=============================================================================\n-    # Purpose: Initialize the test harness using production config logic.\n-    #=============================================================================\n-    def __init__(self, config: Optional[GatewayConfig] = None):\n-        \"\"\"Initialize the client. Uses production configuration logic.\"\"\"\n-        self.config = config or GatewayConfig()\n-        self.session = get_session(self.config)\n-\n-    #=============================================================================\n-    # 1. CORE RPC: call()\n-    #=============================================================================\n-    #=============================================================================\n-    # RPC CALL: call()\n-    #=============================================================================\n-    # Purpose: Wrap production execute_mcp_tool logic for testing.\n-    #=============================================================================\n-    def call(self, tool_name: str, arguments: Dict[str, Any]) -> Dict[str, Any]:\n-        \"\"\"Wrap production tool execution.\"\"\"\n-        return execute_mcp_tool(tool_name, arguments, config=self.config, session=self.session)\n-\n-    #=============================================================================\n-    # 2. DISCOVERY: list_tools()\n-    #=============================================================================\n-    #=============================================================================\n-    # DISCOVERY: list_tools()\n-    #=============================================================================\n-    # Purpose: Wrap production get_mcp_tools logic for discovery testing.\n-    #=============================================================================\n-    def list_tools(self, gateway_slug: Optional[str] = None) -> Dict[str, Any]:\n-        \"\"\"Wrap production tool discovery.\"\"\"\n-        return get_mcp_tools(gateway_slug, config=self.config, session=self.session)\n-\n-    #=============================================================================\n-    # 3. HEARTBEAT: health_check()\n-    #=============================================================================\n-    #=============================================================================\n-    # HEARTBEAT: health_check()\n-    #=============================================================================\n-    # Purpose: Verify the Gateway /health endpoint is responsive.\n-    #=============================================================================\n-    def health_check(self) -> bool:\n-        \"\"\"Verify the Gateway is alive.\"\"\"\n-        try:\n-            resp = self.session.get(f\"{self.config.url}/health\", timeout=5)\n-            return resp.status_code == 200\n-        except Exception:\n-            return False\n-\n-    #=============================================================================\n-    # 5. FLEET RESOLUTION: get_fleet()\n-    #=============================================================================\n-    # Purpose: Provide tests with access to the resolved fleet topology.\n-    #=============================================================================\n-    def get_fleet(self) -> Dict[str, Dict[str, Any]]:\n-        \"\"\"Get the current resolved fleet topology.\"\"\"\n-        return get_resolved_fleet()\n-\n-    def get_cluster_spec(self, alias: str) -> Dict[str, Any]:\n-        \"\"\"Get resolution for a specific cluster alias.\"\"\"\n-        if alias not in FLEET_SPEC:\n-            raise ValueError(f\"Unknown cluster alias: {alias}\")\n-        return resolve_server(FLEET_SPEC[alias])"
            }
          ],
          "isError": false
        }
      },
      "error": null,
      "duration_ms": 95.39413452148438,
      "success": true
    },
    {
      "tool_name": "sanctuary-git-git-get-safety-rules",
      "timestamp": "2025-12-26T04:42:43.247067Z",
      "input_args": {},
      "output": {
        "success": true,
        "result": {
          "content": [
            {
              "type": "text",
              "text": "\ud83d\udee1\ufe0f GIT SAFETY PRIMER: UNBREAKABLE RULES FOR AGENTS \ud83d\udee1\ufe0f\n1. SYNCHRONIZATION FIRST: Pull main before starting.\n2. MAIN IS PROTECTED: Never commit to main.\n3. SERIAL PROCESSING: One feature branch at a time.\n4. STATE VERIFICATION: Check status before acting.\n5. DESTRUCTIVE ACTION GATE: No force pushes without approval.\n6. NO GHOST EDITS: Verify branch before editing."
            }
          ],
          "isError": false
        }
      },
      "error": null,
      "duration_ms": 40.39907455444336,
      "success": true
    },
    {
      "tool_name": "sanctuary-git-git-add",
      "timestamp": "2025-12-26T04:42:43.501420Z",
      "input_args": {
        "files": []
      },
      "output": {
        "success": true,
        "result": {
          "content": [
            {
              "type": "text",
              "text": "Staged all changes on feature/147-dual-transport-sse-servers"
            }
          ],
          "isError": false
        }
      },
      "error": null,
      "duration_ms": 250.1680850982666,
      "success": true
    },
    {
      "tool_name": "sanctuary-git-git-smart-commit",
      "timestamp": "2025-12-26T04:42:44.614241Z",
      "input_args": {
        "message": "[E2E-TEST] Test commit message - should fail with no staged changes"
      },
      "output": {
        "success": true,
        "result": {
          "content": [
            {
              "type": "text",
              "text": "Commit successful. Hash: [PII_REDACTED]"
            }
          ],
          "isError": false
        }
      },
      "error": null,
      "duration_ms": 1107.5677871704102,
      "success": true
    },
    {
      "tool_name": "sanctuary-git-git-start-feature",
      "timestamp": "2025-12-26T04:42:44.780328Z",
      "input_args": {
        "task_id": 999,
        "description": "e2e-test-feature"
      },
      "output": null,
      "error": {
        "code": -32000,
        "message": "Internal error",
        "data": "Tool invocation failed: unhandled errors in a TaskGroup (1 sub-exception)"
      },
      "duration_ms": 163.9690399169922,
      "success": false
    },
    {
      "tool_name": "sanctuary-git-git-push-feature",
      "timestamp": "2025-12-26T04:42:47.351190Z",
      "input_args": {},
      "output": {
        "success": true,
        "result": {
          "content": [
            {
              "type": "text",
              "text": "Verified push to feature/147-dual-transport-sse-servers (Hash: 2ccfdd19).\nLink: https://github.com/richfrem/Project_Sanctuary/pull/new/feature/147-dual-transport-sse-servers"
            }
          ],
          "isError": false
        }
      },
      "error": null,
      "duration_ms": 2567.1560764312744,
      "success": true
    },
    {
      "tool_name": "sanctuary-git-git-finish-feature",
      "timestamp": "2025-12-26T04:42:48.033205Z",
      "input_args": {
        "branch_name": "feature/999-e2e-test-feature",
        "force": false
      },
      "output": null,
      "error": {
        "code": -32000,
        "message": "Internal error",
        "data": "Tool invocation failed: unhandled errors in a TaskGroup (1 sub-exception)"
      },
      "duration_ms": 679.9070835113525,
      "success": false
    }
  ]
}