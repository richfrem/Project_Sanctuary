# Implementation Plan: [FEATURE]
*Path: [templates/plan-template.md](templates/plan-template.md)*


**Branch**: `007-obsidian-agent-integration-suite` | **Date**: 2026-02-26 | **Spec**: [kitty-specs/007-obsidian-agent-integration-suite/spec.md](spec.md)
**Input**: Feature specification from `/kitty-specs/007-obsidian-agent-integration-suite/spec.md`

## Summary

The Obsidian Agent Integration Suite replaces the legacy monolithic sync script with a modular Plugin-and-Skills ecosystem. 
It establishes a formalized integration strategy (ADRs for architecture and data mapping) and provides autonomous agents with explicit skills to interact with the local vault (CRUD operations, Graph traversal) and export sealed knowledge fragments to Hugging Face JSONL format (`soul_traces.jsonl`).

## Technical Context

**Language/Version**: Python 3.13 
**Primary Dependencies**: `datasets`, `huggingface_hub`, built-in JSON/Pathlib. The integration strategy is explicitly deferred to Phase 0 Research (WP01). WP01 MUST aggressively evaluate Obsidian's capabilities to determine overlap with our existing `rlm-factory` and `vector-db` plugins.   
**Storage**: Local Filesystem (Obsidian Markdown Vault) & Hugging Face Hub (JSONL)  
**Testing**: Unittest framework, local dry-run verifications.  
**Target Platform**: CLI / Agent Environment.
**Project Type**: Python Plugin ecosystem (`plugins/` directory). 
**Performance Goals**: Fast graph traversal (< 2 seconds for a graph of 50 links). Seamless linking between disparate research files.
**Constraints**: Must strictly adhere to the Hugging Face `soul_traces.jsonl` schema (ADR 081). Must handle rate limits and strictly ignore large binary attachments.
**Scale/Scope**: 6 Work Packages representing pure Research (ADRs), 3 Agent Skills (CRUD, Graph, Export), and 1 Repository Cleanup task.

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

- [x] **Zero Trust Git**: Ensure WP05 (Forge Soul) does not push to HF without a Git clean-state check.
- [x] **Tool Discovery**: Ensure agent dependencies on `rlm-factory` and `vector-db` are explicitly audited in WP01.
- [x] **Docs First**: ADR must precede code for both the Obsidian Integration Strategy and the HF Data Mapping.

## Project Structure

### Documentation (this feature)

```
kitty-specs/[###-feature]/
├── plan.md              # This file (/spec-kitty.plan command output)
├── research.md          # Phase 0 output (/spec-kitty.plan command)
├── data-model.md        # Phase 1 output (/spec-kitty.plan command)
├── quickstart.md        # Phase 1 output (/spec-kitty.plan command)
├── contracts/           # Phase 1 output (/spec-kitty.plan command)
└── tasks.md             # Phase 2 output (/spec-kitty.tasks command - NOT created by /spec-kitty.plan)
```

### Source Code (repository root)

```
plugins/obsidian-integration/
├── skills/
│   ├── obsidian-crud/
│   │   ├── SKILL.md
│   │   └── scripts/
│   ├── obsidian-graph/
│   │   ├── SKILL.md
│   │   └── scripts/
│   └── forge-soul/
│       ├── SKILL.md
│       └── scripts/
```

**Structure Decision**: This feature will establish a new `obsidian-integration` plugin containing the three autonomous skills, cleanly separating the system from legacy MCP logic.

## Work Packages

The implementation of `007-obsidian-agent-integration-suite` is structured into 6 sequential Work Packages (WPs). Note that `tasks.md` will be formally generated by the `/spec-kitty.tasks` command based on this plan.

1. **WP01: Research Obsidian Integration Strategy & Capability Overlap (ADR)**
   - **Goal:** Determine the optimal architectural pattern for reading/writing Obsidian nodes (Direct Markdown parsing vs. Local REST API vs. Custom Plugin). Crucially, this research MUST map Obsidian's native capabilities against Project Sanctuary's existing `rlm-factory` and `vector-db` skills to determine overlaps, redundancies, or pivot opportunities.
   - **Output:** An approved Architectural Decision Record (ADR) detailing the chosen strategy and capability alignment.

2. **WP02: Research Data Mapping to HF Schema (ADR)**
   - **Goal:** Analyze how complex nested folders and frontmatter arrays safely map to the existing `HF_JSONL` schema (ADR 081) while adhering to the rule that all images and binary attachments are strictly ignored.
   - **Output:** An approved ADR detailing how `source_path` metadata replaces physical directory nesting.

3. **WP03: Build Obsidian CRUD Skill**
   - **Goal:** Implement the `obsidian-crud` plugin skill based on the WP01 ADR.
   - **Output:** A self-contained Agent Skill capable of reading, writing, and updating local Obsidian vault notes with verification testing.

4. **WP04: Build Obsidian Graph Traversal Skill**
   - **Goal:** Implement the `obsidian-graph` plugin skill capable of parsing internal links to return a localized relationship map (backlinks and forward links) for a target node.
   - **Output:** A verified traversal skill.

5. **WP05: Build 'Forge Soul' Semantic Exporter Skill**
   - **Goal:** Implement the `forge-soul` plugin skill capable of aggregating sealed Obsidian notes and formatting them into the `soul_traces.jsonl` export schema according to the rules from WP02.
   - **Output:** A verified semantic export skill.

6. **WP06: Legacy Scrubbing & Automated Link Refactoring**
   - **Goal:** Remove all references to the obsolete "MCP architecture" from existing prompt templates. Develop and run a Python script to locate legacy relative markdown links (e.g., `[Link](../../file.md)`) and convert them into Obsidian wikilinks (`[[file]]`) across the `01_PROTOCOLS/` and `02_LEARNING/` directories.
   - **Output:** Clean `grep` results for "MCP", and all relevant relative links refactored to wikilinks.